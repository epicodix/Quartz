---
title: 08_01ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ê¶Œí•œ ê´€ë¦¬ ê°€ì´ë“œ - IAM, RBAC, Context ì „í™˜ì˜ í•µì‹¬
tags:
  - kubernetes
  - iam
  - rbac
  - context
  - security
  - devops
  - infrastructure
aliases:
  - k8sê¶Œí•œê´€ë¦¬
  - ì¿ ë²„ë„¤í‹°ìŠ¤ë³´ì•ˆ
  - ì»¨í…ìŠ¤íŠ¸ì „í™˜
date: 2025-11-24
category: k8sì‹¤ìŠµ/ì¿ ë²„ë„¤í‹°ìŠ¤
status: ì™„ì„±
priority: ë†’ìŒ
---

# ğŸ¯ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ê¶Œí•œ ê´€ë¦¬ ê°€ì´ë“œ - IAM, RBAC, Context ì „í™˜ì˜ í•µì‹¬

## ğŸ“‘ ëª©ì°¨
- [[#1. ë¡œì»¬ vs í´ë¼ìš°ë“œ í™˜ê²½ì˜ ê·¹ëª…í•œ ì°¨ì´ì |í™˜ê²½ë³„ ì°¨ì´ì ]]
- [[#2. ë¡œì»¬ ë©€í‹° í´ëŸ¬ìŠ¤í„° í™˜ê²½ êµ¬ì¶•í•˜ê¸°|ë¡œì»¬ ë©€í‹° í´ëŸ¬ìŠ¤í„°]]
- [[#3. í´ë¼ìš°ë“œ IAMê³¼ ì¿ ë²„ë„¤í‹°ìŠ¤ RBAC í†µí•© ì´í•´|IAMê³¼ RBAC]]
- [[#4. ì»¨í…ìŠ¤íŠ¸ ì „í™˜: ì™œ í•„ìˆ˜ì ì¸ê°€?|ì»¨í…ìŠ¤íŠ¸ ì „í™˜ì˜ í•„ìˆ˜ì„±]]
- [[#5. ì‹¤ì œ í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ë†“ì¹˜ê¸° ì‰¬ìš´ ì°¨ì´ì ë“¤|í´ë¼ìš°ë“œ í˜„ì‹¤]]
- [[#ğŸ¯ ì‹¤ì „ ë³´ì•ˆ ì‹œë‚˜ë¦¬ì˜¤|ì‹¤ì „ ë³´ì•ˆ ì‹œë‚˜ë¦¬ì˜¤]]

---

## 1. ë¡œì»¬ vs í´ë¼ìš°ë“œ í™˜ê²½ì˜ ê·¹ëª…í•œ ì°¨ì´ì 

> [!note] í•µì‹¬ ê°œë…
> ë¡œì»¬ ê°œë°œ í™˜ê²½ê³¼ í´ë¼ìš°ë“œ í™˜ê²½ì€ ê¶Œí•œ ê´€ë¦¬ ë°©ì‹ì´ ì™„ì „íˆ ë‹¤ë¦…ë‹ˆë‹¤. ì´ ì°¨ì´ì ì„ ì´í•´í•˜ì§€ ëª»í•˜ë©´ í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ì‹¬ê°í•œ ë³´ì•ˆ ì‚¬ê³ ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ  ë¡œì»¬ í™˜ê²½ (minikube, kind, Docker Desktop)

**ğŸ¤” ì§ˆë¬¸**: "ë‚´ ë…¸íŠ¸ë¶ì—ì„œëŠ” ëª¨ë“  ê²Œ ì˜ ë˜ëŠ”ë°, í´ë¼ìš°ë“œì—ì„œëŠ” ì™œ ì•ˆ ë ê¹Œ?"

#### ğŸ“‹ ë¡œì»¬ í™˜ê²½ì˜ íŠ¹ì§•ê³¼ í•¨ì •

> [!example] ë¡œì»¬ ê°œë°œ ì‹œ ì¼ë°˜ì ì¸ ìƒí™©
> 1. **ì „ëŠ¥í•œ ê¶Œí•œ**: ë¡œì»¬ì—ì„œëŠ” ë³´í†µ cluster-admin ê¶Œí•œìœ¼ë¡œ ì‘ì—…
> 2. **ë‹¨ìˆœí•œ ì¸ì¦**: kubeconfig íŒŒì¼ í•˜ë‚˜ë¡œ ëª¨ë“  ê²ƒ í•´ê²°
> 3. **ë³´ì•ˆ ê³ ë ¤ ë¶€ì¡±**: "ë‚´ ì»´í“¨í„°ë‹ˆê¹Œ ê´œì°®ê² ì§€"ë¼ëŠ” ìƒê°
> 4. **í˜„ì‹¤ê³¼ì˜ ê´´ë¦¬**: í´ë¼ìš°ë“œ ë°°í¬ ì‹œ ê¶Œí•œ ì˜¤ë¥˜ í­ë°œ

#### ğŸ’» ë¡œì»¬ í™˜ê²½ ê¶Œí•œ í™•ì¸

```bash
# ğŸ“Š ë¡œì»¬ í™˜ê²½ì—ì„œì˜ ê¶Œí•œ í™•ì¸
# minikube
kubectl auth can-i "*" "*"
# ê²°ê³¼: yes (ë³´í†µ cluster-admin ê¶Œí•œ)

# í˜„ì¬ ì‚¬ìš©ì í™•ì¸
kubectl config view --minify -o jsonpath='{.users[0].name}'
# ê²°ê³¼: minikube (ë˜ëŠ” docker-desktop)

# ëª¨ë“  ê¶Œí•œ í™•ì¸
kubectl auth can-i --list
# ê²°ê³¼: ê±°ì˜ ëª¨ë“  ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ëª¨ë“  ë™ì‘ ê°€ëŠ¥
```

#### ğŸ“Š ë¡œì»¬ í™˜ê²½ë³„ ê¶Œí•œ ë¹„êµ

| ë„êµ¬ | ê¸°ë³¸ ê¶Œí•œ | ì¸ì¦ ë°©ì‹ | ë³´ì•ˆ ìˆ˜ì¤€ |
|------|-----------|----------|----------|
| **minikube** | cluster-admin | í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œ | ë§¤ìš° ë‚®ìŒ |
| **Docker Desktop** | cluster-admin | ë‚´ì¥ ì¸ì¦ | ë§¤ìš° ë‚®ìŒ |
| **kind** | cluster-admin | kubeconfig | ë§¤ìš° ë‚®ìŒ |
| **k3s** | cluster-admin | í† í° ê¸°ë°˜ | ë‚®ìŒ |

### â˜ï¸ í´ë¼ìš°ë“œ í™˜ê²½ (AWS EKS, GCP GKE, Azure AKS)

**ğŸ¤” ì§ˆë¬¸**: "í´ë¼ìš°ë“œì—ì„œëŠ” ì™œ ì´ë ‡ê²Œ ë³µì¡í•˜ê³  ì—„ê²©í• ê¹Œ?"

#### ğŸ“‹ í´ë¼ìš°ë“œ í™˜ê²½ì˜ í˜„ì‹¤ì  ì œì•½

> [!example] í´ë¼ìš°ë“œ ì²« ë°°í¬ ì‹œ ê²ªëŠ” ì¼
> 1. **IAM ì¸ì¦ í•„ìš”**: AWS/GCP/Azure ê³„ì • ì¸ì¦ ë¨¼ì € í•„ìš”
> 2. **ë‹¤ì¸µ ê¶Œí•œ êµ¬ì¡°**: í´ë¼ìš°ë“œ IAM + ì¿ ë²„ë„¤í‹°ìŠ¤ RBAC
> 3. **ë„¤íŠ¸ì›Œí¬ ì œí•œ**: VPC, ì„œë¸Œë„·, ë³´ì•ˆ ê·¸ë£¹ ì„¤ì • í•„ìš”
> 4. **ë¹„ìš© ê³ ë ¤**: ì˜ëª»ëœ ì„¤ì •ìœ¼ë¡œ ì¸í•œ ì˜ˆìƒì¹˜ ëª»í•œ ê³¼ê¸ˆ

#### ğŸ’» í´ë¼ìš°ë“œë³„ ì¸ì¦ ê³¼ì •

```bash
# ğŸ“Š AWS EKS ì ‘ê·¼ ê³¼ì •
# 1. AWS CLI ì¸ì¦
aws configure
aws sts get-caller-identity

# 2. EKS í´ëŸ¬ìŠ¤í„° ì¸ì¦ ì •ë³´ ì—…ë°ì´íŠ¸
aws eks update-kubeconfig --region us-west-2 --name my-cluster

# 3. ê¶Œí•œ í™•ì¸ (ì²˜ìŒì—” ê±°ì˜ ì•„ë¬´ê²ƒë„ ëª»í•¨)
kubectl auth can-i get pods
# ê²°ê³¼: no (ê¸°ë³¸ì ìœ¼ë¡œ ê¶Œí•œ ì—†ìŒ)

# 4. aws-auth ConfigMapì— ì‚¬ìš©ì ì¶”ê°€ í•„ìš”
kubectl get configmap aws-auth -n kube-system -o yaml
```

```bash
# ğŸ“Š GCP GKE ì ‘ê·¼ ê³¼ì •
# 1. gcloud ì¸ì¦
gcloud auth login
gcloud config set project my-project

# 2. GKE í´ëŸ¬ìŠ¤í„° ì¸ì¦ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
gcloud container clusters get-credentials my-cluster \
  --zone us-central1-a

# 3. ê¶Œí•œ í™•ì¸
kubectl auth can-i get pods
# ê²°ê³¼: depends on IAM roles

# 4. RBAC ì„¤ì • í•„ìš”
kubectl create clusterrolebinding my-binding \
  --clusterrole=view \
  --user=$(gcloud config get-value account)
```

#### ğŸ“Š ë¡œì»¬ vs í´ë¼ìš°ë“œ ë¹„êµí‘œ

| êµ¬ë¶„ | ë¡œì»¬ í™˜ê²½ | í´ë¼ìš°ë“œ í™˜ê²½ |
|------|-----------|---------------|
| **ì¸ì¦** | ë‹¨ìˆœ (kubeconfigë§Œ) | ë³µí•© (í´ë¼ìš°ë“œ IAM + k8s RBAC) |
| **ê¶Œí•œ** | ì „ì²´ ê¶Œí•œ (cluster-admin) | ìµœì†Œ ê¶Œí•œ ì›ì¹™ |
| **ë„¤íŠ¸ì›Œí¬** | localhost | VPC, ë°©í™”ë²½, ë¡œë“œë°¸ëŸ°ì„œ |
| **ë¹„ìš©** | ë¬´ë£Œ | ì‹œê°„ë‹¹ ê³¼ê¸ˆ |
| **ë³´ì•ˆ** | ê°œì¸ ì»´í“¨í„° ìˆ˜ì¤€ | ì—”í„°í”„ë¼ì´ì¦ˆ ìˆ˜ì¤€ |
| **ë³µì¡ë„** | ë§¤ìš° ë‹¨ìˆœ | ë†’ìŒ |

---

## 2. ë¡œì»¬ ë©€í‹° í´ëŸ¬ìŠ¤í„° í™˜ê²½ êµ¬ì¶•í•˜ê¸°

> [!note] í•µì‹¬ ê°œë…
> ë¡œì»¬ì—ì„œ ì—¬ëŸ¬ ê°œì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì¶•í•˜ì—¬ ì‹¤ì œ ì—”í„°í”„ë¼ì´ì¦ˆ í™˜ê²½ê³¼ ìœ ì‚¬í•œ ë©€í‹° í´ëŸ¬ìŠ¤í„° ê¶Œí•œ ê´€ë¦¬ë¥¼ ì—°ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ—ï¸ ë¡œì»¬ ë©€í‹° í´ëŸ¬ìŠ¤í„° ì•„í‚¤í…ì²˜ ì„¤ê³„

**ğŸ¤” ì§ˆë¬¸**: "ì‹¤ì œ íšŒì‚¬ì—ì„œëŠ” ê°œë°œ/ìŠ¤í…Œì´ì§•/í”„ë¡œë•ì…˜ í´ëŸ¬ìŠ¤í„°ê°€ ë¶„ë¦¬ë˜ì–´ ìˆëŠ”ë°, ë¡œì»¬ì—ì„œë„ ë¹„ìŠ·í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆì„ê¹Œ?"

#### ğŸ“‹ ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ë©€í‹° í´ëŸ¬ìŠ¤í„° ì‹œë®¬ë ˆì´ì…˜

> [!example] ë¡œì»¬ í™˜ê²½ì—ì„œ êµ¬ì¶•í•  í´ëŸ¬ìŠ¤í„°ë“¤
> 1. **dev-cluster** (kind): ììœ ë¡œìš´ ê°œë°œ í™˜ê²½
> 2. **staging-cluster** (minikube): í”„ë¡œë•ì…˜ ìœ ì‚¬ í™˜ê²½
> 3. **prod-cluster** (k3s): ì œí•œì  í”„ë¡œë•ì…˜ ì‹œë®¬ë ˆì´ì…˜
> 4. **mgmt-cluster** (Docker Desktop): ëª¨ë‹ˆí„°ë§/ê´€ë¦¬ ì „ìš©

#### ğŸ’» ì‹¤ì œ ë©€í‹° í´ëŸ¬ìŠ¤í„° êµ¬ì¶• ê³¼ì •

```bash
# ğŸ“Š 1. ê°œë°œ í´ëŸ¬ìŠ¤í„° ìƒì„± (kind)
cat <<EOF > dev-cluster-config.yaml
kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
name: dev-cluster
nodes:
- role: control-plane
  extraPortMappings:
  - containerPort: 80
    hostPort: 8080
- role: worker
EOF

kind create cluster --config dev-cluster-config.yaml

# ğŸ“Š 2. ìŠ¤í…Œì´ì§• í´ëŸ¬ìŠ¤í„° ìƒì„± (minikube)
minikube start -p staging \
  --memory=4096 \
  --cpus=2 \
  --disk-size=20g \
  --kubernetes-version=v1.28.0

# ğŸ“Š 3. í”„ë¡œë•ì…˜ ì‹œë®¬ë ˆì´ì…˜ í´ëŸ¬ìŠ¤í„° (k3s)
curl -sfL https://get.k3s.io | INSTALL_K3S_NAME=prod sh -
# kubeconfigë¥¼ ~/.kube/config-prodë¡œ ë³µì‚¬

# ğŸ“Š 4. ê´€ë¦¬ í´ëŸ¬ìŠ¤í„° (Docker Desktop í™œìš©)
# Docker Desktopì˜ Kubernetes í™œì„±í™”
```

#### ğŸ“Š í´ëŸ¬ìŠ¤í„°ë³„ íŠ¹ì„± ë§¤íŠ¸ë¦­ìŠ¤

| í´ëŸ¬ìŠ¤í„° | ë„êµ¬ | CPU/Memory | ìš©ë„ | ê¶Œí•œ ìˆ˜ì¤€ |
|----------|------|------------|------|----------|
| **dev** | kind | 2GB | ììœ ë¡œìš´ ì‹¤í—˜ | cluster-admin |
| **staging** | minikube | 4GB | í†µí•© í…ŒìŠ¤íŠ¸ | ì œí•œì  admin |
| **prod** | k3s | 2GB | í”„ë¡œë•ì…˜ ì‹œë®¬ë ˆì´ì…˜ | ìµœì†Œ ê¶Œí•œ |
| **mgmt** | Docker Desktop | 1GB | ëª¨ë‹ˆí„°ë§ ë„êµ¬ | read-only |

### ğŸ”‘ í´ëŸ¬ìŠ¤í„°ë³„ ê¶Œí•œ ì²´ê³„ ì„¤ì •

**ğŸ¤” ì§ˆë¬¸**: "ê° í™˜ê²½ë§ˆë‹¤ ì–´ë–»ê²Œ ë‹¤ë¥¸ ê¶Œí•œ ì •ì±…ì„ ì ìš©í• ê¹Œ?"

#### ğŸ“‹ í™˜ê²½ë³„ ê¶Œí•œ ì •ì±… ì„¤ê³„

> [!example] ì‹¤ì œ ê¸°ì—…ì˜ ê¶Œí•œ ì •ì±… ì‹œë®¬ë ˆì´ì…˜
> 1. **ê°œë°œ í™˜ê²½**: ê°œë°œìì—ê²Œ ê±°ì˜ ëª¨ë“  ê¶Œí•œ
> 2. **ìŠ¤í…Œì´ì§•**: ë°°í¬ ê¶Œí•œì€ CI/CDë§Œ, ì½ê¸°ëŠ” ê°œë°œì
> 3. **í”„ë¡œë•ì…˜**: SREë§Œ ì“°ê¸° ê¶Œí•œ, ê°œë°œìëŠ” ì½ê¸° ì „ìš©
> 4. **ê´€ë¦¬**: ëª¨ë‹ˆí„°ë§íŒ€ë§Œ ì ‘ê·¼ ê°€ëŠ¥

#### ğŸ’» í´ëŸ¬ìŠ¤í„°ë³„ RBAC ì„¤ì •

```bash
# ğŸ“Š ê°œë°œ í´ëŸ¬ìŠ¤í„° - ê´€ëŒ€í•œ ê¶Œí•œ
kubectl config use-context kind-dev-cluster
kubectl create namespace development

cat <<EOF | kubectl apply -f -
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: developers-full-access
subjects:
- kind: User
  name: developer
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: cluster-admin
  apiGroup: rbac.authorization.k8s.io
EOF
```

```bash
# ğŸ“Š ìŠ¤í…Œì´ì§• í´ëŸ¬ìŠ¤í„° - ì œí•œì  ê¶Œí•œ
kubectl config use-context staging
kubectl create namespace staging

cat <<EOF | kubectl apply -f -
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: staging
  name: staging-developer
rules:
- apiGroups: ["", "apps", "extensions"]
  resources: ["*"]
  verbs: ["get", "list", "watch"]
- apiGroups: [""]
  resources: ["pods/log", "pods/portforward"]
  verbs: ["get", "list", "create"]
EOF
```

```bash
# ğŸ“Š í”„ë¡œë•ì…˜ í´ëŸ¬ìŠ¤í„° - ìµœì†Œ ê¶Œí•œ
kubectl config use-context k3s-prod
kubectl create namespace production

cat <<EOF | kubectl apply -f -
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: production
  name: prod-read-only
rules:
- apiGroups: ["", "apps"]
  resources: ["pods", "services", "deployments"]
  verbs: ["get", "list", "watch"]
EOF
```

#### ğŸ¯ ì‚¬ìš©ìë³„ kubeconfig ìƒì„±

```bash
# ğŸ“Š ê°œë°œììš© ì œí•œëœ kubeconfig ìƒì„±
# 1. ServiceAccount ìƒì„±
kubectl create serviceaccount jane-developer -n development

# 2. í† í° ì¶”ì¶œ
TOKEN=$(kubectl create token jane-developer -n development)

# 3. ì œí•œëœ kubeconfig ìƒì„±
kubectl config set-cluster dev-cluster \
  --server=$(kubectl config view -o jsonpath='{.clusters[0].cluster.server}') \
  --certificate-authority-data=$(kubectl config view --raw -o jsonpath='{.clusters[0].cluster.certificate-authority-data}') \
  --kubeconfig=jane-dev-config

kubectl config set-credentials jane-developer \
  --token=$TOKEN \
  --kubeconfig=jane-dev-config

kubectl config set-context jane-dev-context \
  --cluster=dev-cluster \
  --user=jane-developer \
  --namespace=development \
  --kubeconfig=jane-dev-config

kubectl config use-context jane-dev-context --kubeconfig=jane-dev-config
```

---

## 3. í´ë¼ìš°ë“œ IAMê³¼ ì¿ ë²„ë„¤í‹°ìŠ¤ RBAC í†µí•© ì´í•´

> [!note] í•µì‹¬ ê°œë…
> í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œëŠ” í´ë¼ìš°ë“œ IAMê³¼ ì¿ ë²„ë„¤í‹°ìŠ¤ RBACê°€ í•¨ê»˜ ì‘ë™í•˜ì—¬ ì´ì¤‘ ë³´ì•ˆì„ ì œê³µí•©ë‹ˆë‹¤. ì´ ê´€ê³„ë¥¼ ì´í•´í•˜ëŠ” ê²ƒì´ í•µì‹¬ì…ë‹ˆë‹¤.

### ğŸ” ì´ì¤‘ ë³´ì•ˆ ê³„ì¸µì˜ ì‘ë™ ì›ë¦¬

**ğŸ¤” ì§ˆë¬¸**: "í´ë¼ìš°ë“œ IAMê³¼ ì¿ ë²„ë„¤í‹°ìŠ¤ RBACëŠ” ì–´ë–»ê²Œ í•¨ê»˜ ì‘ë™í• ê¹Œ?"

#### ğŸ“‹ ì´ì¤‘ ì¸ì¦ ê³¼ì •

> [!example] AWS EKSì—ì„œì˜ ì‹¤ì œ ì¸ì¦ ê³¼ì •
> 1. **1ë‹¨ê³„ (í´ë¼ìš°ë“œ IAM)**: AWS IAMìœ¼ë¡œ í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ ê¶Œí•œ í™•ì¸
> 2. **2ë‹¨ê³„ (K8s RBAC)**: í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ì—ì„œ ì„¸ë¶€ ê¶Œí•œ í™•ì¸
> 3. **ë§¤í•‘**: aws-auth ConfigMapì´ IAM ì‚¬ìš©ìë¥¼ K8s ì‚¬ìš©ìë¡œ ë³€í™˜
> 4. **ê¶Œí•œ ì ìš©**: K8s RBAC ê·œì¹™ì— ë”°ë¼ ì‹¤ì œ ì‘ì—… ê¶Œí•œ ê²°ì •

#### ğŸ’» AWS EKS IAM + RBAC í†µí•© ì„¤ì •

```bash
# ğŸ“Š 1. AWS IAM ì •ì±… ìƒì„± (í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ìš©)
aws iam create-policy \
  --policy-name EKSClusterAccess \
  --policy-document '{
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Action": [
          "eks:DescribeCluster",
          "eks:ListClusters"
        ],
        "Resource": "*"
      }
    ]
  }'

# ğŸ“Š 2. aws-auth ConfigMap ì„¤ì • (IAM â†’ K8s ì‚¬ìš©ì ë§¤í•‘)
kubectl get configmap aws-auth -n kube-system -o yaml > aws-auth.yaml

# aws-auth.yaml í¸ì§‘í•˜ì—¬ ì‚¬ìš©ì ì¶”ê°€
cat <<EOF >> aws-auth.yaml
  mapUsers: |
    - userarn: arn:aws:iam::123456789:user/developer
      username: developer
      groups:
        - system:masters
EOF

kubectl apply -f aws-auth.yaml

# ğŸ“Š 3. K8s RBAC ê·œì¹™ ì„¤ì •
cat <<EOF | kubectl apply -f -
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: developer-role
rules:
- apiGroups: ["", "apps"]
  resources: ["pods", "services", "deployments"]
  verbs: ["get", "list", "create", "update", "delete"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: developer-binding
subjects:
- kind: User
  name: developer
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: developer-role
  apiGroup: rbac.authorization.k8s.io
EOF
```

#### ğŸ“Š í´ë¼ìš°ë“œë³„ IAM + RBAC í†µí•© ë°©ì‹

| í´ë¼ìš°ë“œ | IAM ì„œë¹„ìŠ¤ | K8s í†µí•© ë°©ì‹ | ì‚¬ìš©ì ë§¤í•‘ |
|----------|------------|---------------|-------------|
| **AWS EKS** | AWS IAM | aws-auth ConfigMap | mapUsers/mapRoles |
| **GCP GKE** | Google Cloud IAM | ìë™ ì—°ë™ | Google ê³„ì • ì§ì ‘ ë§¤í•‘ |
| **Azure AKS** | Azure AD | AAD í†µí•© | Azure AD ê·¸ë£¹ ë§¤í•‘ |

### ğŸ¯ IRSAì™€ Workload Identity ì´í•´

**ğŸ¤” ì§ˆë¬¸**: "íŒŒë“œê°€ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì— ì ‘ê·¼í•  ë•ŒëŠ” ì–´ë–»ê²Œ ê¶Œí•œì„ ê´€ë¦¬í• ê¹Œ?"

#### ğŸ“‹ íŒŒë“œ ìˆ˜ì¤€ í´ë¼ìš°ë“œ ê¶Œí•œ ê´€ë¦¬

> [!example] íŒŒë“œê°€ S3ì— ì ‘ê·¼í•˜ëŠ” ê³¼ì • (AWS)
> 1. **ServiceAccount ìƒì„±**: K8s ServiceAccount + AWS IAM Role ì—°ê²°
> 2. **IRSA ì„¤ì •**: IAM Roles for Service Accounts í™œì„±í™”
> 3. **íŒŒë“œ ë°°í¬**: ServiceAccountë¥¼ ì‚¬ìš©í•˜ëŠ” íŒŒë“œ ìƒì„±
> 4. **ìë™ ì¸ì¦**: íŒŒë“œê°€ ìë™ìœ¼ë¡œ AWS ì„œë¹„ìŠ¤ ì ‘ê·¼ ê¶Œí•œ íšë“

#### ğŸ’» IRSA ì„¤ì • ì˜ˆì‹œ

```bash
# ğŸ“Š AWS IRSA ì„¤ì •
# 1. OIDC ê³µê¸‰ì ìƒì„±
eksctl utils associate-iam-oidc-provider \
  --cluster my-cluster \
  --approve

# 2. IRSA ìƒì„±
eksctl create iamserviceaccount \
  --name s3-access-sa \
  --namespace default \
  --cluster my-cluster \
  --attach-policy-arn arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess \
  --approve

# 3. íŒŒë“œì—ì„œ ServiceAccount ì‚¬ìš©
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: s3-app
spec:
  replicas: 1
  selector:
    matchLabels:
      app: s3-app
  template:
    metadata:
      labels:
        app: s3-app
    spec:
      serviceAccountName: s3-access-sa  # IRSA ServiceAccount ì‚¬ìš©
      containers:
      - name: app
        image: amazon/aws-cli
        command: ["sleep", "infinity"]
EOF
```

---

## 4. ì»¨í…ìŠ¤íŠ¸ ì „í™˜: ì™œ í•„ìˆ˜ì ì¸ê°€?

> [!note] í•µì‹¬ ê°œë…
> ì»¨í…ìŠ¤íŠ¸ ì „í™˜ì€ ë‹¤ì¤‘ í´ëŸ¬ìŠ¤í„°, ë‹¤ì¤‘ í™˜ê²½ì—ì„œ ì•ˆì „í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ì‘ì—…í•˜ê¸° ìœ„í•œ í•„ìˆ˜ì ì¸ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. ì˜ëª»ëœ í™˜ê²½ì—ì„œì˜ ì‘ì—…ì€ ì¹˜ëª…ì ì¸ ê²°ê³¼ë¥¼ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### âš¡ ì»¨í…ìŠ¤íŠ¸ ì „í™˜ì´ í•„ìˆ˜ì ì¸ ì´ìœ 

**ğŸ¤” ì§ˆë¬¸**: "í”„ë¡œë•ì…˜ DBë¥¼ ì‹¤ìˆ˜ë¡œ ì‚­ì œí•œ ì ì´ ìˆë‚˜ìš”?"

#### ğŸ“‹ ì‹¤ì œ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤

> [!example] ì‹¤ìˆ˜ë¡œ ì¸í•œ í”„ë¡œë•ì…˜ ì¥ì• 
> 1. **ìƒí™©**: ê°œë°œìê°€ ê°œë°œ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ ì¤‘
> 2. **ì‹¤ìˆ˜**: ì»¨í…ìŠ¤íŠ¸ í™•ì¸ ì—†ì´ `kubectl delete deployment critical-service` ì‹¤í–‰
> 3. **ê²°ê³¼**: í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ê°€ í”„ë¡œë•ì…˜ì´ì–´ì„œ ì‹¤ì œ ì„œë¹„ìŠ¤ ì¤‘ë‹¨
> 4. **êµí›ˆ**: ì»¨í…ìŠ¤íŠ¸ ì „í™˜ê³¼ í™•ì¸ì˜ ì¤‘ìš”ì„± ì¬ì¸ì‹

#### ğŸ’» ì•ˆì „í•œ ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬

```bash
# ğŸ“Š í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ í™•ì¸ (ë§¤ìš° ì¤‘ìš”!)
kubectl config current-context
# ê²°ê³¼: production-cluster-admin

# ëª¨ë“  ì»¨í…ìŠ¤íŠ¸ ì¡°íšŒ
kubectl config get-contexts
# * production-cluster-admin
#   development-cluster-user
#   staging-cluster-user

# ì•ˆì „í•œ ì»¨í…ìŠ¤íŠ¸ ì „í™˜
kubectl config use-context development-cluster-user
kubectl config current-context  # ì¬í™•ì¸ í•„ìˆ˜!

# íŠ¹ì • ëª…ë ¹ì—ë§Œ ë‹¤ë¥¸ ì»¨í…ìŠ¤íŠ¸ ì‚¬ìš©
kubectl get pods --context=staging-cluster-user
```

#### ğŸ›¡ï¸ ì»¨í…ìŠ¤íŠ¸ ì „í™˜ ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€

> [!example] ì»¨í…ìŠ¤íŠ¸ ì•ˆì „ ê´€ë¦¬ ë°©ë²•
> 1. **í•­ìƒ í™•ì¸**: ëª…ë ¹ ì‹¤í–‰ ì „ í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ í™•ì¸
> 2. **í™˜ê²½ë³„ ë¶„ë¦¬**: í”„ë¡œë•ì…˜ê³¼ ê°œë°œ í™˜ê²½ ì»¨í…ìŠ¤íŠ¸ ëª…í™•íˆ êµ¬ë¶„
> 3. **ì œí•œëœ ê¶Œí•œ**: í•„ìš”í•œ ìµœì†Œ ê¶Œí•œë§Œ ë¶€ì—¬
> 4. **ìë™í™”**: ìŠ¤í¬ë¦½íŠ¸ë¡œ ì»¨í…ìŠ¤íŠ¸ ì „í™˜ ìë™í™”

#### ğŸ“Š ì»¨í…ìŠ¤íŠ¸ êµ¬ì„± ìš”ì†Œ

| ìš”ì†Œ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| **Cluster** | ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì •ë³´ | https://prod-k8s.company.com |
| **User** | ì¸ì¦ ì •ë³´ | jane.developer |
| **Namespace** | ê¸°ë³¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ | development |
| **Context** | ìœ„ 3ê°œì˜ ì¡°í•© | dev-jane-context |

#### ğŸ’» ê³ ê¸‰ ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬ ë„êµ¬

```bash
# ğŸ“Š kubectx - ì»¨í…ìŠ¤íŠ¸ ë¹ ë¥¸ ì „í™˜
brew install kubectx
kubectx                    # ì»¨í…ìŠ¤íŠ¸ ëª©ë¡
kubectx development        # ë¹ ë¥¸ ì „í™˜
kubectx -                  # ì´ì „ ì»¨í…ìŠ¤íŠ¸ë¡œ ëŒì•„ê°€ê¸°

# kubens - ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë¹ ë¥¸ ì „í™˜  
kubens                     # ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ëª©ë¡
kubens production          # ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì „í™˜

# kubeconfig íŒŒì¼ ì§ì ‘ í¸ì§‘
kubectl config view        # í˜„ì¬ ì„¤ì • í™•ì¸
kubectl config set-context my-context \
  --cluster=prod-cluster \
  --user=jane.admin \
  --namespace=default
```

#### ğŸš¨ ì»¨í…ìŠ¤íŠ¸ í˜¼ë™ ë°©ì§€

```bash
# ğŸ“Š í”„ë¡¬í”„íŠ¸ì— í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ í‘œì‹œ
# ~/.bashrc ë˜ëŠ” ~/.zshrcì— ì¶”ê°€
kube_ps1() {
  local context=$(kubectl config current-context 2>/dev/null)
  if [[ -n "$context" ]]; then
    echo "[k8s:$context]"
  fi
}
PS1='$(kube_ps1) \u@\h:\w\$ '

# ìœ„í—˜í•œ í™˜ê²½ì—ì„œ ì¶”ê°€ í™•ì¸ ê°•ì œ
prod_kubectl() {
  local current_context=$(kubectl config current-context)
  if [[ "$current_context" == *"prod"* ]]; then
    echo "âš ï¸  PRODUCTION ENVIRONMENT!"
    echo "Current context: $current_context"
    echo "Command: kubectl $@"
    read -p "Are you sure? (yes/no): " confirm
    if [[ "$confirm" == "yes" ]]; then
      kubectl "$@"
    else
      echo "Command cancelled."
    fi
  else
    kubectl "$@"
  fi
}
alias kubectl=prod_kubectl
```

---

## 5. ì‹¤ì œ í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ë†“ì¹˜ê¸° ì‰¬ìš´ ì°¨ì´ì ë“¤

> [!note] í•µì‹¬ ê°œë…
> ë¡œì»¬ í™˜ê²½ì—ì„œ ì˜ ë™ì‘í•˜ë˜ ê²ƒë“¤ì´ í´ë¼ìš°ë“œì—ì„œëŠ” ì˜ˆìƒê³¼ ë‹¤ë¥´ê²Œ ë™ì‘í•˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. ì´ëŸ° ì°¨ì´ì ì„ ë¯¸ë¦¬ ì´í•´í•˜ê³  ì¤€ë¹„í•´ì•¼ í•©ë‹ˆë‹¤.

### âš¡ í´ë¼ìš°ë“œ í™˜ê²½ì˜ ìˆ¨ê²¨ì§„ ë³µì¡ì„±

**ğŸ¤” ì§ˆë¬¸**: "ë¡œì»¬ì—ì„œëŠ” ì˜ ë˜ëŠ”ë°, AWS EKSì— ë°°í¬í•˜ë©´ ì™œ ê¶Œí•œ ì˜¤ë¥˜ê°€ ë‚ ê¹Œ?"

#### ğŸ“‹ ì‹¤ì œ í´ë¼ìš°ë“œ ë°°í¬ ì‹œ ë§ˆì£¼ì¹˜ëŠ” ë¬¸ì œë“¤

> [!example] í´ë¼ìš°ë“œ ë°°í¬ ì²«ë‚  ê²ªëŠ” ì¼ë“¤
> 1. **IAM ì—­í•  ë§¤í•‘**: aws-auth ConfigMap ì„¤ì • í•„ìš”
> 2. **ë„¤íŠ¸ì›Œí¬ ì •ì±…**: VPC, ì„œë¸Œë„·, ë³´ì•ˆ ê·¸ë£¹ì˜ ë³µì¡í•¨
> 3. **ì„œë¹„ìŠ¤ ê³„ì • ê¶Œí•œ**: íŒŒë“œê°€ AWS ì„œë¹„ìŠ¤ ì ‘ê·¼ ì‹œ í•„ìš”í•œ IRSA
> 4. **ë¡œë“œë°¸ëŸ°ì„œ ì œí•œ**: ALB ì¸ê·¸ë ˆìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ ì„¤ì •ì˜ ë³µì¡ì„±

#### ğŸ’» AWS EKSì˜ í˜„ì‹¤ì ì¸ ê¶Œí•œ ì„¤ì •

```bash
# ğŸ“Š ì‹¤ì œ EKS í´ëŸ¬ìŠ¤í„°ì—ì„œ ê²ªëŠ” ê¶Œí•œ ë¬¸ì œë“¤

# 1. kubectl ëª…ë ¹ì´ ì•ˆ ë˜ëŠ” ì´ìœ 
kubectl get pods
# error: You must be logged in to the server (Unauthorized)

# í•´ê²°: aws-auth ConfigMapì— ì‚¬ìš©ì ì¶”ê°€
kubectl get configmap aws-auth -n kube-system -o yaml
# í˜„ì¬ ì‚¬ìš©ìë¥¼ mapUsersì— ì¶”ê°€í•´ì•¼ í•¨

# 2. íŒŒë“œê°€ AWS ì„œë¹„ìŠ¤ì— ì ‘ê·¼í•˜ì§€ ëª»í•˜ëŠ” ì´ìœ 
kubectl logs my-pod
# error: unable to load AWS credentials

# í•´ê²°: IRSA (IAM Roles for Service Accounts) ì„¤ì •
eksctl create iamserviceaccount \
  --name my-service-account \
  --namespace default \
  --cluster my-cluster \
  --attach-policy-arn arn:aws:iam::aws:policy/S3ReadOnlyAccess \
  --approve
```

#### ğŸ“Š í´ë¼ìš°ë“œë³„ ê¶Œí•œ ë³µì¡ë„ ë¹„êµ

| ìš”ì†Œ | ë¡œì»¬ í™˜ê²½ | AWS EKS | GCP GKE | Azure AKS |
|------|-----------|---------|---------|-----------|
| **ê¸°ë³¸ ì ‘ê·¼** | cluster-admin | IAM ì‚¬ìš©ì ë§¤í•‘ í•„ìš” | Google ê³„ì • ìë™ ì—°ë™ | Azure AD í†µí•© |
| **íŒŒë“œ ê¶Œí•œ** | ì œí•œ ì—†ìŒ | IRSA ì„¤ì • í•„ìš” | Workload Identity | Pod Managed Identity |
| **ë„¤íŠ¸ì›Œí¬** | localhost | VPC ì„¤ì • | VPC ë„¤ì´í‹°ë¸Œ | VNET í†µí•© |
| **ìŠ¤í† ë¦¬ì§€** | hostPath | EBS/EFS | Persistent Disk | Azure Disk |

### ğŸ” í´ë¼ìš°ë“œ í™˜ê²½ ê¶Œí•œ ë””ë²„ê¹… ê°€ì´ë“œ

**ğŸ¤” ì§ˆë¬¸**: "í´ë¼ìš°ë“œì—ì„œ ê¶Œí•œ ì˜¤ë¥˜ê°€ ë‚¬ì„ ë•Œ ì–´ë””ì„œë¶€í„° í™•ì¸í•´ì•¼ í• ê¹Œ?"

#### ğŸ“‹ ë‹¨ê³„ë³„ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸

> [!example] ê¶Œí•œ ì˜¤ë¥˜ í•´ê²° ìˆœì„œ
> 1. **í´ë¼ìš°ë“œ IAM í™•ì¸**: í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ ê¶Œí•œì´ ìˆëŠ”ê°€?
> 2. **Kubernetes RBAC í™•ì¸**: í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ ê¶Œí•œì´ ìˆëŠ”ê°€?
> 3. **ë„¤íŠ¸ì›Œí¬ í™•ì¸**: VPC/ì„œë¸Œë„· ì„¤ì •ì´ ì˜¬ë°”ë¥¸ê°€?
> 4. **ì„œë¹„ìŠ¤ ê³„ì • í™•ì¸**: íŒŒë“œê°€ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì— ì ‘ê·¼ ê°€ëŠ¥í•œê°€?

#### ğŸ’» ì‹¤ì œ ë””ë²„ê¹… ëª…ë ¹ì–´ë“¤

```bash
# ğŸ“Š AWS EKS ê¶Œí•œ ë””ë²„ê¹…
# 1. í˜„ì¬ IAM ì‚¬ìš©ì/ì—­í•  í™•ì¸
aws sts get-caller-identity

# 2. EKS í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ ê¶Œí•œ í™•ì¸
aws eks describe-cluster --name my-cluster

# 3. aws-auth ConfigMap í™•ì¸
kubectl get configmap aws-auth -n kube-system -o yaml

# 4. í˜„ì¬ ì‚¬ìš©ìì˜ K8s ê¶Œí•œ í™•ì¸
kubectl auth can-i "*" "*" --all-namespaces
kubectl auth whoami

# 5. íŠ¹ì • íŒŒë“œì˜ ì„œë¹„ìŠ¤ ê³„ì • í™•ì¸
kubectl get pod my-pod -o jsonpath='{.spec.serviceAccountName}'
kubectl describe serviceaccount my-service-account
```

#### âš ï¸ í´ë¼ìš°ë“œë³„ ì£¼ì˜ì‚¬í•­

> [!warning] ìì£¼ ë†“ì¹˜ëŠ” í´ë¼ìš°ë“œ ì„¤ì •ë“¤
> **AWS EKS**:
> - aws-auth ConfigMap ì„¤ì • ëˆ„ë½
> - IRSA (IAM Roles for Service Accounts) ë¯¸ì„¤ì •
> - VPC CNI í”ŒëŸ¬ê·¸ì¸ ê¶Œí•œ ë¶€ì¡±
> 
> **GCP GKE**:
> - Workload Identity ë¯¸í™œì„±í™”
> - GCP API ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”
> - ë„¤íŠ¸ì›Œí¬ ì •ì±… ì¶©ëŒ
> 
> **Azure AKS**:
> - Azure AD Pod Identity ë¯¸ì„¤ì •
> - RBACì™€ Azure AD í†µí•© ë¬¸ì œ
> - Network Security Group ì œí•œ

### ğŸ’¡ í´ë¼ìš°ë“œ í™˜ê²½ í•™ìŠµ ì „ëµ

#### ë¡œì»¬ì—ì„œ í´ë¼ìš°ë“œ ì°¨ì´ì  ë¯¸ë¦¬ ì²´í—˜í•˜ê¸°

```bash
# ğŸ“Š ë¡œì»¬ì—ì„œ í´ë¼ìš°ë“œ í™˜ê²½ ì‹œë®¬ë ˆì´ì…˜
# 1. ì œí•œëœ ServiceAccount ìƒì„± (IAM ì‚¬ìš©ì ì‹œë®¬ë ˆì´ì…˜)
kubectl create serviceaccount cloud-user-sim
kubectl create token cloud-user-sim

# 2. ìµœì†Œ ê¶Œí•œë§Œ ë¶€ì—¬ (ì‹¤ì œ í´ë¼ìš°ë“œì™€ ìœ ì‚¬)
cat <<EOF | kubectl apply -f -
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: cloud-user-role
  namespace: default
rules:
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["get", "list"]
- apiGroups: ["apps"]
  resources: ["deployments"]
  verbs: ["get", "list", "watch"]
EOF

# 3. ë„¤íŠ¸ì›Œí¬ ì •ì±…ìœ¼ë¡œ í´ë¼ìš°ë“œ ë„¤íŠ¸ì›Œí¬ ì œí•œ ì‹œë®¬ë ˆì´ì…˜
cat <<EOF | kubectl apply -f -
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: simulate-cloud-network
  namespace: default
spec:
  podSelector:
    matchLabels:
      app: restricted-app
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          app: allowed-app
    ports:
    - protocol: TCP
      port: 8080
EOF
```

---

## ğŸ¯ ì‹¤ì „ ë³´ì•ˆ ì‹œë‚˜ë¦¬ì˜¤

### ğŸš¨ ì¼ë°˜ì ì¸ ë³´ì•ˆ ì‚¬ê³ ì™€ ì˜ˆë°©ë²•

#### ì‹œë‚˜ë¦¬ì˜¤ 1: ê¶Œí•œ ì—ìŠ¤ì»¬ë ˆì´ì…˜ ê³µê²©

```bash
# ğŸ“Š ê³µê²© ì‹œë„ íƒì§€
# ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ê¶Œí•œ ìƒìŠ¹ ì‹œë„
kubectl get clusterrolebindings -o json | \
  jq '.items[] | select(.roleRef.name=="cluster-admin")'

# ServiceAccountì˜ ê³¼ë„í•œ ê¶Œí•œ í™•ì¸
kubectl get clusterrolebindings -o custom-columns=\
  NAME:.metadata.name,ROLE:.roleRef.name,SERVICE_ACCOUNT:.subjects[?(@.kind=="ServiceAccount")].name
```

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ì˜ëª»ëœ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì ‘ê·¼

```bash
# ğŸ“Š ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ ì ‘ê·¼ ê¶Œí•œ ê°ì‚¬
for ns in $(kubectl get ns -o name | cut -d/ -f2); do
  echo "=== Namespace: $ns ==="
  kubectl auth can-i "*" "*" --namespace=$ns --as=jane.developer
done
```

#### ì‹œë‚˜ë¦¬ì˜¤ 3: ì»¨í…ìŠ¤íŠ¸ í˜¼ë™ ë°©ì§€

```bash
# ğŸ“Š í”„ë¡¬í”„íŠ¸ì— í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ í‘œì‹œ
# ~/.bashrc ë˜ëŠ” ~/.zshrcì— ì¶”ê°€
kube_ps1() {
  local context=$(kubectl config current-context 2>/dev/null)
  if [[ -n "$context" ]]; then
    echo "[k8s:$context]"
  fi
}
PS1='$(kube_ps1) \u@\h:\w\$ '

# ìœ„í—˜í•œ í™˜ê²½ì—ì„œ ì¶”ê°€ í™•ì¸ ê°•ì œ
prod_kubectl() {
  local current_context=$(kubectl config current-context)
  if [[ "$current_context" == *"prod"* ]]; then
    echo "âš ï¸  PRODUCTION ENVIRONMENT!"
    echo "Current context: $current_context"
    echo "Command: kubectl $@"
    read -p "Are you sure? (yes/no): " confirm
    if [[ "$confirm" == "yes" ]]; then
      kubectl "$@"
    else
      echo "Command cancelled."
    fi
  else
    kubectl "$@"
  fi
}
alias kubectl=prod_kubectl
```

### ğŸ›¡ï¸ ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼

```yaml
# ğŸ“Š ê¶Œí•œ ë³€ê²½ ê°ì‹œ (Falco ê·œì¹™)
apiVersion: v1
kind: ConfigMap
metadata:
  name: falco-rbac-rules
data:
  rbac_rules.yaml: |
    - rule: RBAC Permission Changes
      desc: Detect changes to RBAC permissions
      condition: >
        ka and (
          ka.verb in (create, update, patch, delete) and
          ka.target.resource in (clusterroles, roles, clusterrolebindings, rolebindings)
        )
      output: >
        RBAC permission changed (user=%ka.user.name verb=%ka.verb 
        target=%ka.target.resource/%ka.target.name)
      priority: WARNING
      tags: [rbac, security]
```

### ğŸ“‹ ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

> [!tip] ì¼ì¼ ë³´ì•ˆ ì ê²€ ì‚¬í•­
> 1. **ì»¨í…ìŠ¤íŠ¸ í™•ì¸**: ë§¤ ì‘ì—… ì „ í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ í™•ì¸
> 2. **ìµœì†Œ ê¶Œí•œ ì›ì¹™**: í•„ìš”í•œ ìµœì†Œ ê¶Œí•œë§Œ ë¶€ì—¬
> 3. **ì •ê¸° ê¶Œí•œ ê°ì‚¬**: ì›” 1íšŒ ë¶ˆí•„ìš”í•œ ê¶Œí•œ ì œê±°
> 4. **ë¡œê·¸ ëª¨ë‹ˆí„°ë§**: ê¶Œí•œ ê´€ë ¨ ì´ë²¤íŠ¸ ì‹¤ì‹œê°„ ê°ì‹œ
> 5. **êµìœ¡**: íŒ€ì› ëŒ€ìƒ ë³´ì•ˆ êµìœ¡ ì •ê¸° ì‹¤ì‹œ

### ğŸš€ ìë™í™”ëœ ë³´ì•ˆ ë„êµ¬

```bash
# ğŸ“Š ê¶Œí•œ ê²€ì‚¬ ìë™í™” ìŠ¤í¬ë¦½íŠ¸
#!/bin/bash
# security-audit.sh

echo "ğŸ” Kubernetes Security Audit"
echo "=============================="

echo "ğŸ“Š Cluster Admin Bindings:"
kubectl get clusterrolebindings -o custom-columns=\
  NAME:.metadata.name,SUBJECTS:.subjects[*].name | \
  grep cluster-admin

echo "âš ï¸  Over-privileged ServiceAccounts:"
kubectl get clusterrolebindings -o json | \
  jq -r '.items[] | select(.roleRef.name=="cluster-admin") | 
    select(.subjects[]?.kind=="ServiceAccount") | 
    "\(.metadata.name): \(.subjects[].name)"'

echo "ğŸ” Current Context:"
kubectl config current-context

echo "âœ… Audit Complete"
```

> [!warning] ì¤‘ìš”í•œ ë³´ì•ˆ ì›ì¹™
> 1. **Zero Trust**: ëª¨ë“  ì ‘ê·¼ì„ ê²€ì¦í•˜ê³  ìµœì†Œ ê¶Œí•œ ë¶€ì—¬
> 2. **Defense in Depth**: ë‹¤ì¸µ ë³´ì•ˆ ë°©ì–´ êµ¬ì¡° êµ¬ì¶•  
> 3. **Continuous Monitoring**: ì§€ì†ì ì¸ ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ ë° ê°ì‚¬
> 4. **Incident Response**: ë³´ì•ˆ ì‚¬ê³  ë°œìƒ ì‹œ ì‹ ì†í•œ ëŒ€ì‘ ì²´ê³„

---

## ğŸ“š ì¶”ê°€ í•™ìŠµ ìë£Œ

### ğŸ“ ì‹œí—˜ ëŒ€ë¹„ ë¶€ë¡

> [!tip] ì‹¤ì „ ë¬¸ì œ ì—°ìŠµ
> CKA/CKAD ì‹¤ìŠµ ë¬¸ì œì™€ GCP Professional Cloud Architect ì‹œë‚˜ë¦¬ì˜¤ ë¬¸ì œëŠ” ë³„ë„ ë¶€ë¡ì—ì„œ í™•ì¸í•˜ì„¸ìš”:
> 
> **[[08_01_ì¿ ë²„ë„¤í‹°ìŠ¤_í´ëŸ¬ìŠ¤í„°_ê¶Œí•œ_ê´€ë¦¬_ì‹œí—˜_ë¶€ë¡|ğŸ“ ì‹œí—˜ ë‹¨ê³¨ ë¬¸ì œ & ë¯¸ë‹ˆí€´ì¦ˆ ë¶€ë¡]]**
> 
> - CKA/CKAD ì‹¤ìŠµ ë¬¸ì œ (ServiceAccount, Role, ClusterRole)
> - GCP Professional Cloud Architect ì‹œë‚˜ë¦¬ì˜¤ ë¬¸ì œ
> - ì‹¤ì „ ë¯¸ë‹ˆí€´ì¦ˆ ë° ê²€ì¦ ë°©ë²•
> - ì‹œí—˜ ëŒ€ë¹„ ì „ëµ ë° ì£¼ì˜ì‚¬í•­

### ğŸ”— ê³µì‹ ë¬¸ì„œ ì°¸ê³ 

> [!note] ì¶”ê°€ í•™ìŠµ ë¦¬ì†ŒìŠ¤
> - [Kubernetes RBAC ê³µì‹ ë¬¸ì„œ](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)
> - [GKE Workload Identity ê°€ì´ë“œ](https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity)
> - [CKA/CKAD ì‹œí—˜ ê°€ì´ë“œ](https://github.com/cncf/curriculum)
> - [GCP Professional Cloud Architect ì‹œí—˜ ê°€ì´ë“œ](https://cloud.google.com/certification/cloud-architect)