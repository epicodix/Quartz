---
title: 9-2 ì¿ ë²„ë„¤í‹°ìŠ¤ ë¡¤ë§ ì—…ë°ì´íŠ¸ì™€ ë™ì  ë°°í¬ ì‹¤ìŠµ ì‹œë‚˜ë¦¬ì˜¤
tags:
  - kubernetes
  - hands-on
  - rolling-update
  - metallb
  - helm
  - practice
aliases:
  - k8s-ì‹¤ìŠµ-9-2
  - ë¡¤ë§ì—…ë°ì´íŠ¸ì‹¤ìŠµ
date: 2025-11-28
category: K8s_Deep_Dive/ì‹¤ìŠµ
status: ì‹¤ìŠµìš©
priority: ë†’ìŒ
---

# ğŸš€ 9-2 ì¿ ë²„ë„¤í‹°ìŠ¤ ì‹¤ìŠµ ì‹œë‚˜ë¦¬ì˜¤

> [!info] ì‹¤ìŠµ í™˜ê²½
> - **í´ëŸ¬ìŠ¤í„°**: minikube, kind, ë˜ëŠ” ë©€í‹°ë…¸ë“œ í´ëŸ¬ìŠ¤í„°
> - **í•„ìš” ë„êµ¬**: kubectl, helm, curl
> - **ì˜ˆìƒ ì‹œê°„**: 60-90ë¶„

## ğŸ“‘ ì‹¤ìŠµ ëª©ì°¨
- [[#ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 1: ë¡¤ë§ ì—…ë°ì´íŠ¸ ë§ˆìŠ¤í„°í•˜ê¸°|ì‹œë‚˜ë¦¬ì˜¤ 1: ë¡¤ë§ ì—…ë°ì´íŠ¸]]
- [[#ğŸ”Œ ì‹œë‚˜ë¦¬ì˜¤ 2: MetalLBë¡œ LoadBalancer êµ¬í˜„|ì‹œë‚˜ë¦¬ì˜¤ 2: MetalLB êµ¬í˜„]]
- [[#âš¡ ì‹œë‚˜ë¦¬ì˜¤ 3: Helmìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬|ì‹œë‚˜ë¦¬ì˜¤ 3: Helm ë°°í¬]]
- [[#ğŸ› ï¸ ì‹œë‚˜ë¦¬ì˜¤ 4: í†µí•© ì‹œë‚˜ë¦¬ì˜¤|ì‹œë‚˜ë¦¬ì˜¤ 4: í†µí•© ì‹¤ìŠµ]]

---

## ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤ 1: ë¡¤ë§ ì—…ë°ì´íŠ¸ ë§ˆìŠ¤í„°í•˜ê¸°

### ğŸ“‹ ëª©í‘œ
- ë¬´ì¤‘ë‹¨ ì„œë¹„ìŠ¤ ì—…ë°ì´íŠ¸ ê²½í—˜
- kubectl set/rollout ëª…ë ¹ì–´ ì‹¤ìŠµ
- ì—…ë°ì´íŠ¸ ì „ëµ ì„¤ì • ë° ë¡¤ë°± ì‹¤ìŠµ

### 1ë‹¨ê³„: ê¸°ë³¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬

```bash
# ì‹¤ìŠµìš© ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace rolling-demo
kubectl config set-context --current --namespace=rolling-demo
```

**deployment.yaml ìƒì„±:**
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: webapp
  namespace: rolling-demo
  labels:
    app: webapp
spec:
  replicas: 4
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 2         # ìµœëŒ€ 2ê°œ ì¶”ê°€ Pod í—ˆìš©
      maxUnavailable: 1   # ìµœëŒ€ 1ê°œ Pod ì‚¬ìš© ë¶ˆê°€ í—ˆìš©
  selector:
    matchLabels:
      app: webapp
  template:
    metadata:
      labels:
        app: webapp
        version: v1
    spec:
      containers:
      - name: webapp
        image: nginx:1.20-alpine
        ports:
        - containerPort: 80
        resources:
          requests:
            memory: "64Mi"
            cpu: "50m"
          limits:
            memory: "128Mi"
            cpu: "100m"
        # í—¬ìŠ¤ ì²´í¬ ì„¤ì • (ì¤‘ìš”!)
        readinessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 5
          periodSeconds: 5
        livenessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 10
          periodSeconds: 10
---
apiVersion: v1
kind: Service
metadata:
  name: webapp-service
  namespace: rolling-demo
spec:
  selector:
    app: webapp
  ports:
  - port: 80
    targetPort: 80
  type: NodePort
```

**ë°°í¬ ë° í™•ì¸:**
```bash
# ë°°í¬
kubectl apply -f deployment.yaml

# ìƒíƒœ í™•ì¸
kubectl get pods -w
kubectl get svc
```

### 2ë‹¨ê³„: ë¡¤ë§ ì—…ë°ì´íŠ¸ ì‹¤ìŠµ

**í„°ë¯¸ë„ 1 (ëª¨ë‹ˆí„°ë§):**
```bash
# Pod ë³€í™” ì‹¤ì‹œê°„ ê°ì‹œ
watch -n 1 'kubectl get pods -o wide'
```

**í„°ë¯¸ë„ 2 (ì—…ë°ì´íŠ¸ ì‹¤í–‰):**
```bash
# 1. ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸ (nginx 1.20 â†’ 1.21)
kubectl set image deployment/webapp webapp=nginx:1.21-alpine

# 2. ë¡¤ì•„ì›ƒ ìƒíƒœ í™•ì¸
kubectl rollout status deployment/webapp

# 3. íˆìŠ¤í† ë¦¬ í™•ì¸
kubectl rollout history deployment/webapp

# 4. ì¶”ê°€ ì—…ë°ì´íŠ¸ (nginx 1.22)
kubectl set image deployment/webapp webapp=nginx:1.22-alpine --record

# 5. í™˜ê²½ë³€ìˆ˜ ì¶”ê°€
kubectl set env deployment/webapp VERSION=v2
```

### 3ë‹¨ê³„: ë¡¤ë°± ì‹¤ìŠµ

```bash
# 1. í˜„ì¬ íˆìŠ¤í† ë¦¬ í™•ì¸
kubectl rollout history deployment/webapp

# 2. íŠ¹ì • ë¦¬ë¹„ì „ ìƒì„¸ í™•ì¸
kubectl rollout history deployment/webapp --revision=2

# 3. ì´ì „ ë²„ì „ìœ¼ë¡œ ë¡¤ë°±
kubectl rollout undo deployment/webapp

# 4. íŠ¹ì • ë¦¬ë¹„ì „ìœ¼ë¡œ ë¡¤ë°±
kubectl rollout undo deployment/webapp --to-revision=1

# 5. ë¡¤ë°± ìƒíƒœ í™•ì¸
kubectl rollout status deployment/webapp
```

### ğŸ¯ ì‹¤ìŠµ ê³¼ì œ
1. maxSurgeë¥¼ 1ë¡œ, maxUnavailableì„ 0ìœ¼ë¡œ ë³€ê²½ í›„ ì—…ë°ì´íŠ¸ ì†ë„ ë¹„êµ
2. readinessProbeë¥¼ ì œê±°í•˜ê³  ì—…ë°ì´íŠ¸ ì‹œ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ ê´€ì°°
3. ì˜ëª»ëœ ì´ë¯¸ì§€(nginx:nonexistent)ë¡œ ì—…ë°ì´íŠ¸ í›„ ìë™ ë¡¤ë°± í™•ì¸

---

## ğŸ”Œ ì‹œë‚˜ë¦¬ì˜¤ 2: MetalLBë¡œ LoadBalancer êµ¬í˜„

### ğŸ“‹ ëª©í‘œ
- MetalLB ì„¤ì¹˜ ë° ì„¤ì •
- LoadBalancer íƒ€ì… ì„œë¹„ìŠ¤ ë™ì‘ í™•ì¸
- Layer 2 ëª¨ë“œ ì‹¤ìŠµ

### 1ë‹¨ê³„: MetalLB ì„¤ì¹˜

```bash
# MetalLB ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë° ì„¤ì¹˜
kubectl apply -f https://raw.githubusercontent.com/metallb/metallb/v0.14.5/config/manifests/metallb-native.yaml

# ì„¤ì¹˜ í™•ì¸
kubectl get pods -n metallb-system
kubectl wait --for=condition=available --timeout=300s deployment/controller -n metallb-system
```

### 2ë‹¨ê³„: IP ì£¼ì†Œ í’€ ì„¤ì •

**metallb-config.yaml:**
```yaml
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: example-pool
  namespace: metallb-system
spec:
  addresses:
  # ğŸš¨ ì£¼ì˜: ì‹¤ì œ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì— ë§ê²Œ ìˆ˜ì •í•˜ì„¸ìš”!
  # í™ˆ ë„¤íŠ¸ì›Œí¬ ì˜ˆì‹œ: 192.168.1.240-192.168.1.250
  # minikube/kind ì˜ˆì‹œ: 172.18.255.200-172.18.255.250
  - 192.168.1.240-192.168.1.250
---
apiVersion: metallb.io/v1beta1
kind: L2Advertisement
metadata:
  name: example
  namespace: metallb-system
spec:
  ipAddressPools:
  - example-pool
```

**IP ë²”ìœ„ ì°¾ëŠ” ë°©ë²•:**
```bash
# 1. í˜„ì¬ ë„¤íŠ¸ì›Œí¬ í™•ì¸
ip route | grep default
# ë˜ëŠ”
route -n | grep UG

# 2. ì‚¬ìš© ì¤‘ì¸ IP í™•ì¸
nmap -sn 192.168.1.0/24  # í™ˆ ë„¤íŠ¸ì›Œí¬ ìŠ¤ìº”

# 3. ì‚¬ìš© ì•ˆ í•˜ëŠ” IP ë²”ìœ„ ì„ íƒ
ping 192.168.1.240  # ì‘ë‹µ ì—†ìœ¼ë©´ ì‚¬ìš© ê°€ëŠ¥
```

**ì„¤ì • ì ìš©:**
```bash
# ì„¤ì • ì ìš© (IP ë²”ìœ„ ìˆ˜ì • í›„!)
kubectl apply -f metallb-config.yaml

# ì„¤ì • í™•ì¸
kubectl get ipaddresspool -n metallb-system
kubectl get l2advertisement -n metallb-system
```

### 3ë‹¨ê³„: LoadBalancer ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸

**loadbalancer-test.yaml:**
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-lb-test
  namespace: rolling-demo
spec:
  replicas: 2
  selector:
    matchLabels:
      app: nginx-lb-test
  template:
    metadata:
      labels:
        app: nginx-lb-test
    spec:
      containers:
      - name: nginx
        image: nginx:1.21-alpine
        ports:
        - containerPort: 80
        volumeMounts:
        - name: html
          mountPath: /usr/share/nginx/html
      volumes:
      - name: html
        configMap:
          name: nginx-html
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-html
  namespace: rolling-demo
data:
  index.html: |
    <!DOCTYPE html>
    <html>
    <head><title>MetalLB Test</title></head>
    <body>
      <h1>ğŸ‰ MetalLB ì„±ê³µ!</h1>
      <p>LoadBalancer íƒ€ì… ì„œë¹„ìŠ¤ê°€ ì •ìƒ ë™ì‘ ì¤‘ì…ë‹ˆë‹¤.</p>
      <p>Pod: nginx-lb-test</p>
      <p>ì‹œê°„: $(date)</p>
    </body>
    </html>
---
apiVersion: v1
kind: Service
metadata:
  name: nginx-loadbalancer
  namespace: rolling-demo
spec:
  type: LoadBalancer  # ğŸ”¥ í•µì‹¬!
  ports:
  - port: 80
    targetPort: 80
  selector:
    app: nginx-lb-test
```

**í…ŒìŠ¤íŠ¸ ì‹¤í–‰:**
```bash
# ë°°í¬
kubectl apply -f loadbalancer-test.yaml

# LoadBalancer IP í• ë‹¹ í™•ì¸
kubectl get svc nginx-loadbalancer
# EXTERNAL-IPê°€ pendingì—ì„œ ì‹¤ì œ IPë¡œ ë³€ê²½ë˜ëŠ”ì§€ í™•ì¸!

# í• ë‹¹ëœ IPë¡œ ì ‘ì† í…ŒìŠ¤íŠ¸
EXTERNAL_IP=$(kubectl get svc nginx-loadbalancer -o jsonpath='{.status.loadBalancer.ingress[0].ip}')
echo "LoadBalancer IP: $EXTERNAL_IP"
curl http://$EXTERNAL_IP

# ë¸Œë¼ìš°ì €ì—ì„œë„ ì ‘ì† í…ŒìŠ¤íŠ¸
echo "ë¸Œë¼ìš°ì €ì—ì„œ http://$EXTERNAL_IP ì ‘ì†í•´ë³´ì„¸ìš”!"
```

### ğŸ¯ ì‹¤ìŠµ ê³¼ì œ
1. LoadBalancer ì„œë¹„ìŠ¤ë¥¼ NodePortë¡œ ë³€ê²½í–ˆì„ ë•Œ ì°¨ì´ì  ë¹„êµ
2. ì—¬ëŸ¬ ê°œì˜ LoadBalancer ì„œë¹„ìŠ¤ ìƒì„±í•˜ì—¬ IP í• ë‹¹ í™•ì¸
3. MetalLB Podë¥¼ ì‚­ì œí–ˆì„ ë•Œ ì„œë¹„ìŠ¤ ë³µêµ¬ ê³¼ì • ê´€ì°°

---

## âš¡ ì‹œë‚˜ë¦¬ì˜¤ 3: Helmìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬

### ğŸ“‹ ëª©í‘œ
- Helm Chart ìƒì„± ë° ì»¤ìŠ¤í„°ë§ˆì´ì§•
- í™˜ê²½ë³„ ë°°í¬ ì‹¤ìŠµ
- Helmìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ/ë¡¤ë°± ì‹¤ìŠµ

### 1ë‹¨ê³„: Helm í™˜ê²½ ì¤€ë¹„

```bash
# Helm ì„¤ì¹˜ í™•ì¸
helm version

# Bitnami ì €ì¥ì†Œ ì¶”ê°€
helm repo add bitnami https://charts.bitnami.com/bitnami
helm repo update

# ì‚¬ìš© ê°€ëŠ¥í•œ ì°¨íŠ¸ ê²€ìƒ‰
helm search repo nginx
```

### 2ë‹¨ê³„: ê¸°ë³¸ Chart ë°°í¬

```bash
# ê°œë°œ í™˜ê²½ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace helm-demo

# nginx Chart ê¸°ë³¸ ì„¤ì •ê°’ í™•ì¸
helm show values bitnami/nginx > nginx-default-values.yaml

# ê¸°ë³¸ ì„¤ì¹˜
helm install my-nginx bitnami/nginx \
  --namespace helm-demo \
  --set replicaCount=3 \
  --set service.type=LoadBalancer

# ì„¤ì¹˜ ìƒíƒœ í™•ì¸
helm list -n helm-demo
helm status my-nginx -n helm-demo
kubectl get all -n helm-demo
```

### 3ë‹¨ê³„: ì»¤ìŠ¤í…€ values íŒŒì¼ ìƒì„±

**nginx-custom-values.yaml:**
```yaml
# ë³µì œë³¸ ì„¤ì •
replicaCount: 3

# ì´ë¯¸ì§€ ì„¤ì •
image:
  repository: nginx
  tag: "1.21-alpine"
  pullPolicy: IfNotPresent

# ì„œë¹„ìŠ¤ ì„¤ì •
service:
  type: LoadBalancer
  port: 80
  targetPort: http
  nodePorts:
    http: ""

# ë¦¬ì†ŒìŠ¤ ì œí•œ
resources:
  limits:
    cpu: 200m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 128Mi

# ì»¤ìŠ¤í…€ HTML í˜ì´ì§€
staticSiteConfigmap: |-
  <!DOCTYPE html>
  <html>
  <head>
    <title>Helm Demo App</title>
    <style>
      body { font-family: Arial; text-align: center; padding: 50px; }
      .version { color: #007acc; font-size: 2em; }
    </style>
  </head>
  <body>
    <h1>ğŸš¢ Helmìœ¼ë¡œ ë°°í¬ëœ ì• í”Œë¦¬ì¼€ì´ì…˜</h1>
    <p class="version">Version 1.0</p>
    <p>ì´ í˜ì´ì§€ëŠ” Helm Chartë¡œ ë°°í¬ë˜ì—ˆìŠµë‹ˆë‹¤!</p>
  </body>
  </html>

# Ingress ì„¤ì • (ì„ íƒì‚¬í•­)
ingress:
  enabled: false

# Pod ë³´ì•ˆ ì„¤ì •
podSecurityContext:
  fsGroup: 1001

# ì»¨í…Œì´ë„ˆ ë³´ì•ˆ ì„¤ì •  
containerSecurityContext:
  runAsUser: 1001
  runAsNonRoot: true
```

**ì—…ê·¸ë ˆì´ë“œ ë°°í¬:**
```bash
# ì»¤ìŠ¤í…€ ì„¤ì •ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ
helm upgrade my-nginx bitnami/nginx \
  -f nginx-custom-values.yaml \
  -n helm-demo

# ì—…ê·¸ë ˆì´ë“œ ìƒíƒœ í™•ì¸
helm status my-nginx -n helm-demo
kubectl get pods -n helm-demo
```

### 4ë‹¨ê³„: í™˜ê²½ë³„ ë°°í¬ ì‹œë‚˜ë¦¬ì˜¤

**ê°œë°œ í™˜ê²½ (nginx-dev-values.yaml):**
```yaml
replicaCount: 1
resources:
  limits:
    cpu: 100m
    memory: 128Mi
  requests:
    cpu: 50m
    memory: 64Mi
service:
  type: NodePort
staticSiteConfigmap: |-
  <html><body><h1>ğŸ› ï¸ ê°œë°œ í™˜ê²½</h1><p>Development Environment</p></body></html>
```

**ìš´ì˜ í™˜ê²½ (nginx-prod-values.yaml):**
```yaml
replicaCount: 5
resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 250m
    memory: 256Mi
service:
  type: LoadBalancer
staticSiteConfigmap: |-
  <html><body><h1>ğŸš€ ìš´ì˜ í™˜ê²½</h1><p>Production Environment</p></body></html>
```

**í™˜ê²½ë³„ ë°°í¬:**
```bash
# ê°œë°œ í™˜ê²½
kubectl create namespace dev
helm install nginx-dev bitnami/nginx \
  -f nginx-dev-values.yaml \
  -n dev

# ìš´ì˜ í™˜ê²½  
kubectl create namespace prod
helm install nginx-prod bitnami/nginx \
  -f nginx-prod-values.yaml \
  -n prod

# ëª¨ë“  í™˜ê²½ í™•ì¸
helm list -A
kubectl get svc -A | grep nginx
```

### 5ë‹¨ê³„: Helm ì—…ê·¸ë ˆì´ë“œ ë° ë¡¤ë°±

```bash
# ìš´ì˜í™˜ê²½ ë ˆí”Œë¦¬ì¹´ ìˆ˜ ì¦ê°€
helm upgrade nginx-prod bitnami/nginx \
  -f nginx-prod-values.yaml \
  --set replicaCount=8 \
  -n prod

# íˆìŠ¤í† ë¦¬ í™•ì¸
helm history nginx-prod -n prod

# ì´ì „ ë²„ì „ìœ¼ë¡œ ë¡¤ë°±
helm rollback nginx-prod 1 -n prod

# ë¡¤ë°± í™•ì¸
kubectl get pods -n prod
```

### ğŸ¯ ì‹¤ìŠµ ê³¼ì œ
1. ìì²´ Chart ìƒì„± (`helm create my-app`) í›„ ì»¤ìŠ¤í„°ë§ˆì´ì§•
2. í…œí”Œë¦¿ í™•ì¸ (`helm template`) ìœ¼ë¡œ ì‹¤ì œ YAML ì¶œë ¥ ë¹„êµ
3. Helm hooksë¥¼ ì‚¬ìš©í•œ pre-install/post-install ì‘ì—… ì¶”ê°€

---

## ğŸ› ï¸ ì‹œë‚˜ë¦¬ì˜¤ 4: í†µí•© ì‹œë‚˜ë¦¬ì˜¤ - ì‹¤ì „ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬

### ğŸ“‹ ëª©í‘œ
- ë¡¤ë§ ì—…ë°ì´íŠ¸ + MetalLB + Helm í†µí•©
- CI/CD íŒŒì´í”„ë¼ì¸ ì‹œë®¬ë ˆì´ì…˜
- ì‹¤ì œ ìš´ì˜ ì‹œë‚˜ë¦¬ì˜¤ ê²½í—˜

### 1ë‹¨ê³„: ë©€í‹° í‹°ì–´ ì• í”Œë¦¬ì¼€ì´ì…˜ Chart ìƒì„±

```bash
# ìƒˆ Chart ìƒì„±
helm create webapp-stack
cd webapp-stack
```

**values.yaml (ì£¼ìš” ë¶€ë¶„):**
```yaml
# Frontend ì„¤ì •
frontend:
  enabled: true
  replicaCount: 3
  image:
    repository: nginx
    tag: "1.21-alpine"
  service:
    type: LoadBalancer
    port: 80

# Backend ì„¤ì •  
backend:
  enabled: true
  replicaCount: 2
  image:
    repository: httpd
    tag: "2.4-alpine"
  service:
    type: ClusterIP
    port: 8080

# Database ì„¤ì •
database:
  enabled: true
  replicaCount: 1
  image:
    repository: redis
    tag: "6-alpine"
  service:
    type: ClusterIP
    port: 6379

# Global ì„¤ì •
global:
  namespace: webapp-production
```

### 2ë‹¨ê³„: ë°°í¬ íŒŒì´í”„ë¼ì¸ ì‹œë®¬ë ˆì´ì…˜

**pipeline-script.sh:**
```bash
#!/bin/bash
set -e

echo "ğŸš€ ë°°í¬ íŒŒì´í”„ë¼ì¸ ì‹œì‘"

# 1ë‹¨ê³„: ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì¤€ë¹„
echo "ğŸ“ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±..."
kubectl create namespace webapp-production --dry-run=client -o yaml | kubectl apply -f -

# 2ë‹¨ê³„: ì„¤ì • ê²€ì¦
echo "ğŸ” Chart ê²€ì¦..."
helm lint ./webapp-stack

# 3ë‹¨ê³„: í…œí”Œë¦¿ í™•ì¸ 
echo "ğŸ“‹ í…œí”Œë¦¿ ë Œë”ë§ í™•ì¸..."
helm template webapp-production ./webapp-stack --dry-run

# 4ë‹¨ê³„: ë°°í¬ (ë˜ëŠ” ì—…ê·¸ë ˆì´ë“œ)
echo "ğŸš¢ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬..."
helm upgrade --install webapp-production ./webapp-stack \
  --namespace webapp-production \
  --wait \
  --timeout=5m

# 5ë‹¨ê³„: ë°°í¬ í™•ì¸
echo "âœ… ë°°í¬ ìƒíƒœ í™•ì¸..."
helm status webapp-production -n webapp-production
kubectl get all -n webapp-production

# 6ë‹¨ê³„: í—¬ìŠ¤ ì²´í¬
echo "ğŸ” í—¬ìŠ¤ ì²´í¬..."
kubectl wait --for=condition=available --timeout=300s deployment --all -n webapp-production

echo "ğŸ‰ ë°°í¬ ì™„ë£Œ!"
```

### 3ë‹¨ê³„: ë¬´ì¤‘ë‹¨ ì—…ë°ì´íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

```bash
# í”„ë¡ íŠ¸ì—”ë“œ ë²„ì „ ì—…ë°ì´íŠ¸ (v1.21 â†’ v1.22)
echo "ğŸ“¦ í”„ë¡ íŠ¸ì—”ë“œ ì—…ë°ì´íŠ¸ ì‹œì‘..."
helm upgrade webapp-production ./webapp-stack \
  --set frontend.image.tag=1.22-alpine \
  --namespace webapp-production \
  --wait

# ì—…ë°ì´íŠ¸ ì§„í–‰ìƒí™© ëª¨ë‹ˆí„°ë§
kubectl rollout status deployment/webapp-stack-frontend -n webapp-production

# ë°±ì—”ë“œ ì—…ë°ì´íŠ¸ (ë™ì‹œ ëª¨ë‹ˆí„°ë§)
watch -n 2 'kubectl get pods -n webapp-production'
```

### 4ë‹¨ê³„: ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤ ë° ë³µêµ¬

```bash
# 1. ì˜ëª»ëœ ì´ë¯¸ì§€ë¡œ ì—…ë°ì´íŠ¸ (ì¥ì•  ì‹œë®¬ë ˆì´ì…˜)
helm upgrade webapp-production ./webapp-stack \
  --set frontend.image.tag=nonexistent-version \
  --namespace webapp-production

# 2. ì¥ì•  ìƒí™© í™•ì¸
kubectl get pods -n webapp-production
kubectl describe pod [failed-pod-name] -n webapp-production

# 3. ì‹ ì†í•œ ë¡¤ë°±
helm rollback webapp-production -n webapp-production

# 4. ë³µêµ¬ í™•ì¸
kubectl get pods -n webapp-production
helm status webapp-production -n webapp-production
```

### ğŸ¯ ìµœì¢… ì‹¤ìŠµ ê³¼ì œ

1. **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**: LoadBalancer IPë¡œ ë¶€í•˜í…ŒìŠ¤íŠ¸ ìˆ˜í–‰
2. **ìŠ¤ì¼€ì¼ë§ í…ŒìŠ¤íŠ¸**: HPA ì„¤ì • í›„ ìë™ ìŠ¤ì¼€ì¼ë§ í™•ì¸  
3. **ì¬í•´ë³µêµ¬**: ì „ì²´ ì‚­ì œ í›„ Helmìœ¼ë¡œ ë¹ ë¥¸ ë³µêµ¬
4. **ëª¨ë‹ˆí„°ë§**: Prometheus + Grafana ì—°ë™

---

## ğŸ” ì‹¤ìŠµ ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

### âœ… ë¡¤ë§ ì—…ë°ì´íŠ¸ ë§ˆìŠ¤í„°
- [ ] ë¬´ì¤‘ë‹¨ ì—…ë°ì´íŠ¸ ì„±ê³µ
- [ ] ì—…ë°ì´íŠ¸ ì „ëµ ì„¤ì • ë³€ê²½ í…ŒìŠ¤íŠ¸  
- [ ] ë¡¤ë°± ê¸°ëŠ¥ í™œìš©
- [ ] í—¬ìŠ¤ ì²´í¬ ì¤‘ìš”ì„± ì´í•´

### âœ… MetalLB êµ¬í˜„
- [ ] LoadBalancer IP í• ë‹¹ ì„±ê³µ
- [ ] ì™¸ë¶€ì—ì„œ ì›¹ ì ‘ì† í™•ì¸
- [ ] IP í’€ ê´€ë¦¬ ì´í•´
- [ ] Layer 2 ëª¨ë“œ ë™ì‘ ì›ë¦¬ íŒŒì•…

### âœ… Helm ë§ˆìŠ¤í„°  
- [ ] Chart ì„¤ì¹˜/ì—…ê·¸ë ˆì´ë“œ/ì‚­ì œ
- [ ] ì»¤ìŠ¤í…€ values íŒŒì¼ ì‘ì„±
- [ ] í™˜ê²½ë³„ ë°°í¬ êµ¬ë¶„
- [ ] ë²„ì „ ê´€ë¦¬ ë° ë¡¤ë°±

### âœ… í†µí•© ì‹œë‚˜ë¦¬ì˜¤
- [ ] ë©€í‹° ì»´í¬ë„ŒíŠ¸ ë°°í¬
- [ ] íŒŒì´í”„ë¼ì¸ ìë™í™” ìŠ¤í¬ë¦½íŠ¸
- [ ] ì¥ì•  ëŒ€ì‘ ë° ë³µêµ¬
- [ ] ì‹¤ì „ ìš´ì˜ ê²½í—˜

> [!tip] ì‹¤ìŠµ ì„±ê³µ íŒ
> 1. **ë‹¨ê³„ë³„ ì§„í–‰**: ê° ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ìˆœì„œëŒ€ë¡œ ì™„ë£Œ
> 2. **ë¡œê·¸ í™•ì¸**: ë¬¸ì œ ë°œìƒ ì‹œ kubectl logs í™œìš©
> 3. **ìƒíƒœ ëª¨ë‹ˆí„°ë§**: watch ëª…ë ¹ì–´ë¡œ ì‹¤ì‹œê°„ í™•ì¸
> 4. **ë¬¸ì„œí™”**: ì‹¤ìŠµ ê³¼ì •ê³¼ ê²°ê³¼ë¥¼ ê¸°ë¡

---

## ğŸ“š ì‹¤ìŠµ í›„ ì°¸ê³ ìë£Œ

- [Kubernetes ë¡¤ë§ ì—…ë°ì´íŠ¸ ì‹¬í™”](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#rolling-update-deployment)
- [MetalLB ê³ ê¸‰ ì„¤ì •](https://metallb.universe.tf/configuration/)
- [Helm Chart ê°œë°œ ê°€ì´ë“œ](https://helm.sh/docs/chart_template_guide/)
- [ì¿ ë²„ë„¤í‹°ìŠ¤ ìš´ì˜ Best Practices](https://kubernetes.io/docs/concepts/cluster-administration/manage-deployment/)