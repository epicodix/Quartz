# 아키텍처 진화의 3단계: 온프레미스 K8s에서 GKE, 그리고 Cloud Run까지

온프레미스(On-premise) 환경에서 운영하던 쿠버네티스(K8s)를 구글 쿠버네티스 엔진(GKE)으로 옮기고, 나아가 서버리스(Serverless) 플랫폼인 클라우드 런(Cloud Run)으로 전환하는 과정은 현대적인 클라우드 네이티브 아키텍처의 이상적인 진화 경로 중 하나입니다. 

이 과정은 단순히 인프라를 '이사'하는 것을 넘어, **관리의 책임은 줄이고 핵심 비즈니스 가치에 더 집중**하는 방향으로 나아가는 전략적인 여정입니다. 각 단계를 클라우드 아키텍처 관점에서 심도 있게 분석해 보겠습니다.

---

## 1단계: 온프레미스 쿠버네티스 (On-premise Kubernetes)

> **한 줄 요약: "내 땅에 내 손으로 직접 집 짓고 관리하기"**

이 단계에서 기업은 자체 데이터 센터의 물리적 서버 위에 직접 쿠버네티스 클러스터를 구축하고 운영합니다.

### 아키텍처와 책임 범위

- **모든 것을 직접 관리:** 물리 서버, 네트워크 장비, 스토리지부터 시작해서, 그 위에 설치되는 운영체제(OS), 그리고 쿠버네티스의 핵심인 컨트롤 플레인(etcd, API 서버 등)과 워커 노드까지 모든 계층을 직접 책임져야 합니다.

### 장점 (Pros)

1.  **최대 수준의 제어권과 유연성:** 하드웨어 스펙, 네트워크 토폴로지, 스토리지 종류, 쿠버네티스 버전 및 설정 등 모든 것을 원하는 대로 구성할 수 있습니다.
2.  **보안 및 규제 준수:** 금융, 의료 등 민감한 데이터를 다루거나 특정 데이터 주권 규제를 따라야 할 경우, 외부 네트워크와 완전히 격리된 내부 데이터 센터에 인프라를 두는 것이 유리하거나 필수적일 수 있습니다.

### 단점 (Cons) - 우리가 클라우드로 떠나는 이유

1.  **엄청난 운영 오버헤드:** 이것이 가장 큰 문제입니다. 하드웨어 장애 대응, OS 보안 패치, etcd 백업 및 복구, 컨트롤 플레인 업그레이드 등 클러스터를 '살아있게' 유지하는 데 엄청난 노력과 비용이 듭니다. 이를 위해서는 고도로 숙련된 전문 인프라팀이 필수적입니다.
2.  **낮은 탄력성:** 갑자기 트래픽이 몰려 서버 증설이 필요한 경우, 물리 서버를 구매하고, 설치하고, 설정하는 데 몇 주에서 몇 달이 걸릴 수 있습니다. 반대로 트래픽이 줄어도 서버를 줄여 비용을 절감하기 어렵습니다.
3.  **높은 총 소유 비용 (TCO):** 쿠버네티스 소프트웨어 자체는 무료지만, 서버 하드웨어, 상면 비용, 전기세, 냉각 비용, 그리고 전문가팀의 인건비까지 고려하면 총 소유 비용은 매우 높습니다.

---

## 2단계: 구글 쿠버네티스 엔진 (GKE)으로의 "리프트 앤 시프트(Lift and Shift)"

> **한 줄 요약: "잘 지어진 아파트에 입주해서 인테리어만 신경 쓰기"**

이 단계는 온프레미스의 쿠버네티스 워크로드를 관리형 쿠버네티스 서비스인 GKE로 이전하는 과정입니다. 기존 애플리케이션의 아키텍처 변경을 최소화하면서 클라우드의 이점을 누리는, 가장 일반적인 '클라우드 마이그레이션' 전략입니다.

### 아키텍처와 책임 범위

- **컨트롤 플레인은 구글이 책임:** 가장 복잡하고 중요한 '뇌' 역할의 컨트롤 플레인(etcd, API 서버 등)은 구글이 전적으로 관리하고 가용성을 보장합니다. 우리는 더 이상 컨트롤 플레인의 장애나 업그레이드를 걱정할 필요가 없습니다.
- **워커 노드와 애플리케이션에 집중:** 우리는 워커 노드(GCE 가상머신)의 스펙과 개수를 정하고, 그 위에 우리의 애플리케이션 컨테이너(Pod)를 배포하는 것에만 집중하면 됩니다.

### 장점 (Pros)

1.  **운영 부담의 대폭 감소:** 쿠버네티스 관리의 가장 어려운 부분이 사라집니다. 덕분에 인프라팀은 반복적인 유지보수 업무에서 벗어나, CI/CD 파이프라인 개선이나 모니터링 고도화 등 더 높은 가치를 창출하는 일에 집중할 수 있습니다.
2.  **클라우드 네이티브 확장성:** GKE의 '클러스터 오토스케일러' 기능을 사용하면, 부하에 따라 워커 노드의 개수가 몇 분 안에 자동으로 늘어나거나 줄어듭니다. 트래픽 피크에 유연하게 대응하고, 사용한 만큼만 비용을 지불하여 매우 경제적입니다.
3.  **구글 클라우드 생태계와의 완벽한 통합:** Cloud Logging, Monitoring, IAM(보안), VPC(네트워크) 등 다른 구글 클라우드 서비스와 자연스럽게 연동되어, 강력한 모니터링 및 보안 체계를 쉽게 구축할 수 있습니다.

### 단점 (Cons)

1.  **일부 제어권 상실:** 컨트롤 플레인에 직접 접근할 수 없으며, 구글이 제공하는 버전과 설정 범위 내에서만 운영해야 합니다. 대부분의 경우 문제가 없지만, 매우 특수한 커스터마이징이 필요한 경우 제약이 될 수 있습니다.
2.  **클라우드 종속성:** 애플리케이션 자체는 여전히 표준 쿠버네티스 위에서 동작하여 이식성이 높지만, 클러스터를 생성하고 관리하는 방식, IAM 연동 등은 구글 클라우드의 API와 방식에 의존하게 됩니다.

---

## 3단계: 클라우드 런 (Cloud Run)으로의 "현대화(Modernization)"

> **한 줄 요약: "가구와 가전이 완비된 호텔에 몸만 들어가기"**

GKE로 안정적인 운영 환경을 갖춘 후, 아키텍처를 한 단계 더 발전시키는 과정입니다. 이는 **'서버'나 '클러스터'라는 개념 자체를 잊고, 오직 '코드(컨테이너)'에만 집중**하는 서버리스(Serverless) 패러다임으로의 전환을 의미합니다.

### 아키텍처와 책임 범위

- **모든 인프라는 구글이 책임:** 이제 우리는 워커 노드조차 관리하지 않습니다. 클러스터의 존재 자체를 신경 쓸 필요가 없습니다.
- **컨테이너 이미지만 제공:** 우리는 그저 실행 가능한 컨테이너 이미지를 만들어 Cloud Run에 제공하기만 하면 됩니다. 그러면 구글이 알아서 트래픽에 맞춰 컨테이너를 실행하고, 확장하고, 관리합니다.

### 장점 (Pros)

1.  **궁극의 운영 효율성:** 개발자는 인프라에 대한 고민 없이 오직 비즈니스 로직 개발에만 100% 집중할 수 있습니다. 인프라팀의 개입이 거의 필요 없으며, 이는 곧 개발 속도의 극적인 향상으로 이어집니다.
2.  **최고의 비용 효율성 (Pay-per-use):** 요청이 없을 때는 아무런 비용도 발생하지 않습니다 (Scale to Zero). 요청이 들어올 때만 컨테이너가 실행되고, 요청을 처리하는 데 사용된 정확한 CPU와 메모리 양에 대해서만 초 단위로 비용이 청구됩니다. 트래픽이 불규칙하거나 간헐적인 서비스에 매우 경제적입니다.

### 단점 (Cons) 및 고려사항

1.  **제한된 유연성:** 주로 HTTP 요청에 의해 실행되는 **상태 비저장(Stateless)** 애플리케이션에 가장 적합합니다. 항상 백그라운드에서 실행되어야 하는 작업이나, 서버 내부에 파일 등의 상태를 저장해야 하는 애플리케이션에는 적합하지 않을 수 있습니다.
2.  **콜드 스타트 (Cold Start):** 요청이 없어 0개의 인스턴스로 축소된 상태에서 첫 요청이 들어오면, 새로운 컨테이너를 시작하는 데 약간의 지연(수백 ms ~ 몇 초)이 발생할 수 있습니다. 응답 시간이 매우 민감한 서비스의 경우, '최소 인스턴스'를 1 이상으로 설정하여 이 문제를 완화할 수 있습니다.

---

## 결론: Control과 Convenience의 트레이드오프

이 3단계의 여정은 결국 **'제어권(Control)'과 '편의성(Convenience)' 사이의 트레이드오프**를 선택하는 과정입니다.

| 단계 | 제어권 | 편의성/효율성 | 책임 범위 | 적합한 상황 |
| :--- | :--- | :--- | :--- | :--- |
| **1. 온프레미스 K8s** | 최상 | 낮음 | 모든 것 | 높은 보안/규제, 특수 하드웨어 필요 |
| **2. GKE** | 높음 | 높음 | 워커 노드, 애플리케이션 | 대부분의 마이크로서비스, 복잡한 애플리케이션 |
| **3. Cloud Run** | 낮음 | 최상 | 애플리케이션 코드 | 상태 비저장 웹 API, 이벤트 기반 서비스 |

성공적인 클라우드 전환은 모든 것을 한 번에 바꾸려는 시도가 아니라, 우리 조직의 성숙도와 서비스의 특성에 맞춰 **온프레미스 → GKE → Cloud Run**의 스펙트럼 위에서 최적의 지점을 찾아 점진적으로 진화해 나가는 것입니다.

---

**작성일**: 2025-10-30
